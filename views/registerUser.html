<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <title><%= title %></title>
    <link href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet">
</head>
<body style="width: 500px;">
<h1><%= title %></h1>
<form class="form-horizontal" role="form" action="/doRegister" method="post">
    <div class="form-group">
        <label class="col-sm-2 control-label">phone</label>
        <div class="col-sm-10">
            <input type="phone" name="phone" class="form-control" placeholder="phone">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">Password</label>
        <div class="col-sm-10">
            <input type="password" name="password" class="form-control" placeholder="Password">
        </div>
    </div>
    <div class="form-group form-inline">
        <label class="col-sm-2 control-label">验证码</label>
        <div class="col-sm-10">
            <input type="text" name="authCode" class="form-control" placeholder="">
            <input id="authCodeBtn" type="button" class="btn btn-default" value="免费获取验证码" />
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
            <input type="hidden" name="channelId" value="<%= channelId %>"/>
            <button type="submit" class="btn btn-primary">注册</button>
        </div>
    </div>
</form>

<script src="//cdn.bootcss.com/jquery/1.8.3/jquery.js"></script>
<script>
    $(function(){

        // 验证码
        var countdown=10;
        function settime(event,time) {
            if (countdown < 0) {
                event.prop("disabled",false);
                event.val("重新发送");
                countdown = time;
            } else {
                event.prop("disabled", true);
                event.val("重新发送(" + countdown + ")");
                countdown--;

                setTimeout(function() {
                    settime(event,time);
                },1000);
            }

        }

        $("#authCodeBtn").click(function(){
            var regx = /^(13|15|17|18|14)[0-9]{9}$/;
            var phone = $("input[name='phone']").val().trim();

            if(phone.match(regx)){
                console.log('yes..');
                $.get('/authCode?phone=' + phone,function(data){
                    console.log(data);

                });
                settime($(this),10);
            }else{
                alert('请填写正确的手机号码!!');
                console.log('error');
            }



        });


    });

</script>



</body>
</html>